import org.jetbrains.kotlin.gradle.dsl.JvmTarget
import org.jetbrains.kotlin.gradle.tasks.KotlinCompile

plugins {
  alias(libs.plugins.kotlin.jvm)
  id("java-gradle-plugin")
}

gradlePlugin {
  plugins {
    runtime {
      id = "app.cash.sqldelight.toolchain.runtime"
      implementationClass = "app.cash.sqldelight.toolchain.RuntimeToolchainConventions"
    }
    compiler {
      id = "app.cash.sqldelight.toolchain.compiler"
      implementationClass = "app.cash.sqldelight.toolchain.CompilerToolchainConventions"
    }
  }
}

java {
  toolchain {
    languageVersion.set(JavaLanguageVersion.of(17))
  }
}

tasks.withType(JavaCompile).configureEach {
  options.release.set(8)
}

tasks.withType(KotlinCompile).configureEach {
  compilerOptions {
    jvmTarget.set(JvmTarget.JVM_1_8)
  }
}

dependencies {
  compileOnly libs.kotlin.plugin
}
