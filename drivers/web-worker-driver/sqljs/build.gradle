def packageJson = tasks.register("writePackageJson") {
  outputs.file("package.json")

  doLast {
    file("package.json")
      .write("""{
  "name": "@cashapp/sqldelight-sqljs-worker",
  "version": "${rootProject.version}",
  "description": "A SQL.js implementation of SQLDelight's web-worker-driver",
  "main": "index.js",
  "scripts": {
    "test": "echo \\"Error: no test specified\\" && exit 1"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/cashapp/sqldelight.git"
  },
  "keywords": [
    "sqljs",
    "sqldelight",
    "sql"
  ],
  "author": "",
  "license": "Apache-2.0",
  "bugs": {
    "url": "https://github.com/cashapp/sqldelight/issues"
  },
  "homepage": "https://github.com/cashapp/sqldelight#readme",
  "peerDependencies": {
    "sql.js": "^1.8.0"
  }
}
""")
  }
}

rootProject.tasks.named("kotlinNpmInstall").configure {
  dependsOn(packageJson)
}
