apply plugin: 'de.undercouch.download'

task downloadDependencies(type: Download) {
  def downloadDir = new File(project.rootDir, "lib/download")
  downloadDir.mkdirs()

  def intellijCoreZip = new File(downloadDir, "intellij-core-${versions.idea}.zip")

  src "https://www.jetbrains.com/intellij-repository/releases/com/jetbrains/intellij/idea/ideaIC/" +
      "${versions.idea}/ideaIC-${versions.idea}.zip"
  dest intellijCoreZip
  onlyIfNewer true
}

task updateDependencies(dependsOn: downloadDependencies, type: Copy) {
  from zipTree(downloadDependencies.dest)
  into new File("lib/intellij-core")
  onlyIf { downloadDependencies.didWork }
}
